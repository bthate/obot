# This file is placed in the Public Domain.

"rss tests"

# imports

import feedparser
import unittest

from ob import update
from ob.rss import Feed

# classes

class Test_Rss(unittest.TestCase):

    def test_feed(self):
        p = feedparser.parse(txt)
        o = p["entries"][-1]
        f = Feed()
        update(f, dict(o))
        self.assertEqual("bart@dds.nl", f.author)

txt = b'<?xml version="1.0" encoding="UTF-8"?>\n<feed xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" xml:lang="en-US">\n  <id>tag:github.com,2008:/bthate/okbot/commits/master</id>\n  <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commits/master"/>\n  <link type="application/atom+xml" rel="self" href="https://github.com/bthate/okbot/commits/master.atom"/>\n  <title>Recent Commits to okbot:master</title>\n  <updated>2021-02-25T08:54:27Z</updated>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/0c74f19a463b7fb2784798d5344f22d9f3156ef7</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/0c74f19a463b7fb2784798d5344f22d9f3156ef7"/>\n    <title>\n        fix rss\n    </title>\n    <updated>2021-02-25T08:54:27Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;fix rss&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/a1f34e9b852dade93403f885a93bd47d38921d62</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/a1f34e9b852dade93403f885a93bd47d38921d62"/>\n    <title>\n        nice !\n    </title>\n    <updated>2021-02-25T07:02:03Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;nice !&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/acb36b1e7e45e3b5065fd747978c50c2b1167f8e</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/acb36b1e7e45e3b5065fd747978c50c2b1167f8e"/>\n    <title>\n        update for systemd\n    </title>\n    <updated>2021-02-24T18:31:48Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;update for systemd&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/c37a1bbc3c667f3cfd99621a407002df3f6fd18f</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/c37a1bbc3c667f3cfd99621a407002df3f6fd18f"/>\n    <title>\n        okdan\n    </title>\n    <updated>2021-02-24T17:23:10Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;okdan&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/cf748ab52f2a5e6643fef54b07f1a69a386763e9</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/cf748ab52f2a5e6643fef54b07f1a69a386763e9"/>\n    <title>\n        works !\n    </title>\n    <updated>2021-02-24T17:23:02Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;works !&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/06058cddf952876114aa2d4d381e173b1421cefc</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/06058cddf952876114aa2d4d381e173b1421cefc"/>\n    <title>\n        use mod dir\n    </title>\n    <updated>2021-02-23T20:31:59Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;use mod dir&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/7a1b5b0c29dc31e22d1892e883946632b695fe2b</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/7a1b5b0c29dc31e22d1892e883946632b695fe2b"/>\n    <title>\n        okdan !\n    </title>\n    <updated>2021-02-23T16:22:28Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;okdan !&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/21b69b823bf3af91edd5f659047ae36d0da2c90c</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/21b69b823bf3af91edd5f659047ae36d0da2c90c"/>\n    <title>\n        fix tbl\n    </title>\n    <updated>2021-02-23T15:37:00Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;fix tbl&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/b95bdea983b1bd8ae62246bf46fef9f51ee98080</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/b95bdea983b1bd8ae62246bf46fef9f51ee98080"/>\n    <title>\n        use ok/__init__.py\n    </title>\n    <updated>2021-02-23T14:25:54Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;use ok/__init__.py&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/8b11e98d51934929befe0aa4d2ffad0d634ecc40</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/8b11e98d51934929befe0aa4d2ffad0d634ecc40"/>\n    <title>\n        update docstring\n    </title>\n    <updated>2021-02-23T11:59:18Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;update docstring&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/1f26511726ffa4d13675e9dcc6d56a1310d1a23b</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/1f26511726ffa4d13675e9dcc6d56a1310d1a23b"/>\n    <title>\n        add manifest\n    </title>\n    <updated>2021-02-22T23:15:38Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;add manifest&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/3e7eb21f868f44d9b59321f2acb3f372f83b1a36</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/3e7eb21f868f44d9b59321f2acb3f372f83b1a36"/>\n    <title>\n        move to doc\n    </title>\n    <updated>2021-02-22T23:15:21Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;move to doc&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/65964c374c408cf8d482795598c3fcf012e385ac</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/65964c374c408cf8d482795598c3fcf012e385ac"/>\n    <title>\n        use wd\n    </title>\n    <updated>2021-02-22T22:44:46Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;use wd&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/36b1e978cd490ba2756058cdf767f5bbcde24f42</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/36b1e978cd490ba2756058cdf767f5bbcde24f42"/>\n    <title>\n        add version\n    </title>\n    <updated>2021-02-22T22:17:29Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;add version&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/c40a05c8e049b846c4103b568dd8e92dee479457</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/c40a05c8e049b846c4103b568dd8e92dee479457"/>\n    <title>\n        update docs\n    </title>\n    <updated>2021-02-22T16:29:52Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;update docs&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/1ad36b8f90843fe118fca588df8fa0a9ab7f1d17</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/1ad36b8f90843fe118fca588df8fa0a9ab7f1d17"/>\n    <title>\n        fix okbot\n    </title>\n    <updated>2021-02-22T14:03:39Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;fix okbot&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/ebeae85c462935b7a748b40a42a0d4ecf22599e3</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/ebeae85c462935b7a748b40a42a0d4ecf22599e3"/>\n    <title>\n        add public domain notice\n    </title>\n    <updated>2021-02-22T14:02:13Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;add public domain notice&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/2bdbda38ce53edcd6a0172bb6de6805a9e912d41</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/2bdbda38ce53edcd6a0172bb6de6805a9e912d41"/>\n    <title>\n        remove print from ok package\n    </title>\n    <updated>2021-02-22T10:10:04Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;remove print from ok package&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/8758db4a7a4ce2cf333d070e601afa6226a6e69b</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/8758db4a7a4ce2cf333d070e601afa6226a6e69b"/>\n    <title>\n        nice\n    </title>\n    <updated>2021-02-22T08:21:27Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;nice&lt;/pre&gt;\n    </content>\n  </entry>\n  <entry>\n    <id>tag:github.com,2008:Grit::Commit/11741854a93169730ced77892db14ff0b60a8e90</id>\n    <link type="text/html" rel="alternate" href="https://github.com/bthate/okbot/commit/11741854a93169730ced77892db14ff0b60a8e90"/>\n    <title>\n        update hdl\n    </title>\n    <updated>2021-02-21T18:19:31Z</updated>\n    <media:thumbnail height="30" width="30" url="https://1.gravatar.com/avatar/45ec613de56e4fb311ca8c02355c6561?d=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=30"/>\n    <author>\n      <name></name>\n      <email>bart@dds.nl</email>\n    </author>\n    <content type="html">\n      &lt;pre style=&#39;white-space:pre-wrap;width:81ex&#39;&gt;update hdl&lt;/pre&gt;\n    </content>\n  </entry>\n</feed>\n'
